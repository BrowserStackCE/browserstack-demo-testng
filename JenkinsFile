pipeline {
	agent any
	tools {
		maven 'Maven 3.8.1'
	}
	stages {
	    stage ('Checkout') {
			steps {
				git branch: 'jenkins', url: 'https://github.com/BrowserStackCE/browserstack-demo-testng'
			}
		}
	    stage ('Test') {
	        steps {
    			browserstack(credentialsId: "${credentials}") {
                    sh "mvn clean -P ${configuration} test"
                }
	        }
		}
	}
	post {
		always {
			junit 'target/surefire-reports/TEST-*.xml'
			browserStackReportPublisher "${product}"
		}
	}
}